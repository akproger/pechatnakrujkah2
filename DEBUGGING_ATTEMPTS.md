# Отладка проблемы с обводкой основного прямоугольника в режиме "Текст с изображением"

## Проблема
При добавлении текста через режим "Текст с изображением" обводка основного прямоугольника становится размытой и неровной при сохранении в высоком разрешении.

## Неудачные попытки решения

### 1. Изменение размеров канваса в GridSaveCanvas.vue
**Что делали:**
- Заменили `tempCanvas.width = this.canvasWidth` на `tempCanvas.width = textSize.width + padding * 2`
- Заменили `tempCanvas.height = this.canvasHeight` на `tempCanvas.height = textSize.height + padding * 2`
- Обновили позиционирование текста с `x, y` на `textX, textY`
- Исправили позиционирование растров с `viewCenter` на `x, y`

**Результат:** Проблема не решилась, позиционирование сбилось.

### 2. Изменение размера shadowCanvas в TextManager.vue
**Что делали:**
- Заменили `shadowCanvas.width = ctx.canvas.width` на `shadowCanvas.width = textSize.width + padding * 2`
- Заменили `shadowCanvas.height = ctx.canvas.height` на `shadowCanvas.height = textSize.height + padding * 2`

**Результат:** Проблема не решилась.

## Выводы
1. Проблема НЕ в процессе сохранения в GridSaveCanvas.vue
2. Проблема НЕ в размерах канвасов в TextManager.vue
3. Проблема может быть в данных, которые передаются в GridSaveCanvas
4. Проблема может быть в другом месте, не связанном с режимом "Текст с изображением"

## Успешное решение

### 3. Применение подхода из StickerManiaPage (УСПЕШНО)
**Что сделали:**
- Изучили, как реализовано сохранение текстов в режиме "Текст с изображением" в StickerManiaPage
- Обнаружили, что в StickerManiaPage:
  1. НЕ создается подложка для режима "image-text"
  2. Текст рисуется напрямую в методе `drawTextInHighDPI` без использования `savedCanvas`
  3. Создается временный канвас только для маскирования изображения
- Применили тот же подход в MugComicPage:
  1. Убрали использование `savedCanvas` из TextManager
  2. Рисуем текст напрямую в методе `createImageTextBackgroundFromPreviewLogic`
  3. Создаем канвас только под размер текста с отступами
  4. Рисуем тень, изображение с маской и обводку прямо на канвасе

**Результат:** Нужно протестировать, исправлена ли проблема с обводкой основного прямоугольника.

## Следующие шаги
1. Протестировать сохранение в высоком разрешении с текстом в режиме "Текст с изображением"
2. Проверить, что обводка основного прямоугольника теперь четкая и ровная
3. Если проблема решена, закоммитить изменения
