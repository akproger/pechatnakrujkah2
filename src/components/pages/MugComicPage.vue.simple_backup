<template>
  <div class="mug-comic-page">
    <div class="container">
      <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
      <div class="row">
        <div class="col">
          <h2 class="page-title">–ö—Ä—É–∂–∫–∞-–∫–æ–º–∏–∫—Å</h2>
          <p class="text-muted">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–∏–∫—Å–æ–≤ –Ω–∞ –∫—Ä—É–∂–∫–∞—Ö</p>
        </div>
      </div>
      
      <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
      <div class="row mb-2">
        <div class="col-12" style="width: 66.66666667%;">
          <div class="card">
            <div class="card-body" style="padding-left: 10px;">
              <div class="row align-items-center">
                
                <!-- –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ -->
                <div class="col-auto" style="padding: 0; margin-right: 20px;">
                  <div class="tools-panel">
                    <button 
                      class="tool-button"
                      :class="{ 'active': activeTool === 'scalpel' }"
                      disabled
                      title="–°–∫–∞–ª—å–ø–µ–ª—å (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)"
                    >
                      <i class="bi bi-scissors"></i>
                    </button>
                  </div>
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ -->
                <div class="col" style="padding: 0;">
                  <button 
                    @click="openTextManager" 
                    class="btn canvas-button text-button"
                  >
                    <i class="bi bi-type me-2"></i>
                    –¢–µ–∫—Å—Ç
                  </button>
                </div>
                
                <div class="col" style="padding: 0;">
                  <TextManager 
                    ref="textManager"
                    :canvas="$refs.comicCanvas"
                    :paper-scope="paperScope"
                    @text-dialog-opened="onTextDialogOpened"
                    @text-dialog-closed="onTextDialogClosed"
                    @text-applied="onTextApplied"
                  />
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è -->
                <div class="col" style="padding: 0;">
                  <HighQualitySaveButton
                    :save-function="saveCanvasForPrint"
                    :save-params="{}"
                    button-text="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –≤—ã—Å–æ–∫–æ–º –∫–∞—á–µ—Å—Ç–≤–µ"
                    size="medium"
                    variant="primary"
                    @save-success="onSaveSuccess"
                    @save-error="onSaveError"
                    @show-notification="showNotification"
                  />
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Canvas –æ–±–ª–∞—Å—Ç—å –∏ 3D –ø—Ä–µ–≤—å—é -->
      <div class="row">
        <div class="col-md-8">
          <div class="card">
            <div class="card-body p-0">
              <div class="canvas-container">
                <canvas 
                  ref="comicCanvas"
                  class="comic-canvas"
                ></canvas>
                
                <!-- –ü—Ä–µ–ª–æ–∞–¥–µ—Ä -->
                <div v-if="isLoading" class="canvas-overlay">
                  <div class="spinner-border text-light" role="status">
                    <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 3D –ø—Ä–µ–≤—å—é –∫—Ä—É–∂–∫–∏ -->
        <div class="col-md-4">
          <div class="card">
            <div class="card-body p-0">
              <ThreeDRenderer 
                ref="threeRenderer"
                :source-canvas="$refs.comicCanvas"
                :auto-update="true"
                :rotation-speed="0.01"
                :mug-radius="4"
                :mug-height="9.5"
                :print-aspect-ratio="19/9"
                @initialized="onThreeInitialized"
                @texture-updated="onTextureUpdated"
                @texture-error="onTextureError"
              />
            </div>
          </div>
        </div>
      </div>
      
      <!-- –¢–∞–±—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
      <div class="row mt-4">
        <div class="col-12">
          <ul class="nav nav-tabs" id="mugComicTabs" role="tablist">
            <li class="nav-item" role="presentation">
              <button 
                class="nav-link" 
                :class="{ 'active': activeTab === 'images' }"
                id="images-tab" 
                data-bs-toggle="tab" 
                data-bs-target="#images" 
                type="button" 
                role="tab" 
                aria-controls="images" 
                aria-selected="activeTab === 'images'"
                @click="activeTab = 'images'"
              >
                <i class="bi bi-images me-2"></i>
                –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button 
                class="nav-link" 
                :class="{ 'active': activeTab === 'texts' }"
                id="texts-tab" 
                data-bs-toggle="tab" 
                data-bs-target="#texts" 
                type="button" 
                role="tab" 
                aria-controls="texts" 
                aria-selected="activeTab === 'texts'"
                @click="activeTab = 'texts'"
              >
                <i class="bi bi-type me-2"></i>
                –¢–µ–∫—Å—Ç—ã
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button 
                class="nav-link" 
                :class="{ 'active': activeTab === 'settings' }"
                id="settings-tab" 
                data-bs-toggle="tab" 
                data-bs-target="#settings" 
                type="button" 
                role="tab" 
                aria-controls="settings" 
                aria-selected="activeTab === 'settings'"
                @click="activeTab = 'settings'"
              >
                <i class="bi bi-gear me-2"></i>
                –ù–∞—Å—Ç—Ä–æ–π–∫–∏
              </button>
            </li>
          </ul>
        </div>
      </div>
      
      <!-- –ö–æ–Ω—Ç–µ–Ω—Ç —Ç–∞–±–æ–≤ -->
      <div class="tab-content" id="mugComicTabContent">
        <!-- –¢–∞–± "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è" -->
        <div class="tab-pane fade" :class="{ 'show active': activeTab === 'images' }" id="images" role="tabpanel" aria-labelledby="images-tab">
          <div class="row mt-3">
            <div class="col-12">
              <div class="card">
                <div class="card-body">
                  <div class="row g-3">
                    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π -->
                    <div class="col-12">
                      <input 
                        type="file" 
                        ref="imageInput"
                        @change="handleImageUpload" 
                        multiple
                        accept="image/*"
                        class="d-none"
                      >
                      <button 
                        @click="$refs.imageInput.click()" 
                        class="btn"
                        :disabled="uploadedImages.length >= 10"
                        style="background-color: #0d6efd; border: none; color: white;"
                      >
                        <i class="bi bi-cloud-upload me-2"></i>
                        <span v-if="uploadedImages.length >= 10">
                          –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∑–∞–≥—Ä—É–∂–µ–Ω–æ
                        </span>
                        <span v-else-if="uploadedImages.length === 0">
                          –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–¥–æ 10)
                        </span>
                        <span v-else>
                          –î–æ–±–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–æ—Å—Ç–∞–ª–æ—Å—å {{ 10 - uploadedImages.length }})
                        </span>
                      </button>
                    </div>
                    
                    <!-- –°–ø–∏—Å–æ–∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π -->
                    <div class="col-12" v-if="uploadedImages.length > 0">
                      <h6 class="text-muted mb-3">–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h6>
                      <div class="row g-2">
                        <div 
                          v-for="(image, index) in uploadedImages" 
                          :key="index"
                          class="col-md-4 col-lg-3 col-xl-2"
                        >
                          <div class="position-relative">
                            <img 
                              :src="image.url" 
                              :alt="image.name"
                              class="img-fluid rounded border"
                              style="max-height: 100px; width: 100%; object-fit: cover;"
                            >
                            <button 
                              @click="removeImage(index)"
                              class="btn btn-sm position-absolute top-0 end-0 m-1 d-flex align-items-center justify-content-center"
                              style="width: 24px; height: 24px; padding: 0; border-radius: 50%; background-color: #495057; border: none; color: white;"
                            >
                              <i class="bi bi-x" style="font-size: 14px; line-height: 1;"></i>
                            </button>
                          </div>
                          <small class="text-muted d-block mt-1">{{ image.name }}</small>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- –¢–∞–± "–¢–µ–∫—Å—Ç—ã" -->
        <div class="tab-pane fade" :class="{ 'show active': activeTab === 'texts' }" id="texts" role="tabpanel" aria-labelledby="texts-tab">
          <div class="row mt-3">
            <div class="col-12">
              <div class="card">
                <div class="card-body">
                  <h6 class="text-muted mb-3">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ —Å–ª–æ—è–º–∏</h6>
                  
                  <!-- –°–ø–∏—Å–æ–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–ª–æ–µ–≤ -->
                  <div v-if="textLayers.length === 0" class="text-center text-muted py-4">
                    <i class="bi bi-type" style="font-size: 3rem;"></i>
                    <p class="mt-2">–ù–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–¢–µ–∫—Å—Ç" –≤—ã—à–µ, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å.</p>
                  </div>
                  
                  <div v-else class="row g-3">
                    <div 
                      v-for="(layer, index) in textLayers" 
                      :key="layer.id"
                      class="col-12"
                    >
                      <div class="card border">
                        <div class="card-body">
                          <div class="d-flex justify-content-between align-items-start">
                            <div class="flex-grow-1">
                              <h6 class="mb-2">
                                <i class="bi bi-type me-2"></i>
                                –¢–µ–∫—Å—Ç {{ index + 1 }}
                              </h6>
                              <p class="text-muted mb-2 small">{{ layer.text }}</p>
                              <div class="d-flex gap-3 small text-muted">
                                <span><i class="bi bi-fonts me-1"></i>{{ layer.fontSize }}px</span>
                                <span><i class="bi bi-palette me-1"></i>{{ layer.fillColor }}</span>
                              </div>
                            </div>
                            <div class="d-flex gap-2">
                              <button 
                                @click="editTextLayer(index)"
                                class="btn btn-sm btn-outline-primary"
                                title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
                              >
                                <i class="bi bi-pencil"></i>
                              </button>
                              <button 
                                @click="deleteTextLayer(index)"
                                class="btn btn-sm btn-outline-danger"
                                title="–£–¥–∞–ª–∏—Ç—å"
                              >
                                <i class="bi bi-trash"></i>
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- –¢–∞–± "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" -->
        <div class="tab-pane fade" :class="{ 'show active': activeTab === 'settings' }" id="settings" role="tabpanel" aria-labelledby="settings-tab">
          <div class="row mt-3">
            <div class="col-12">
              <div class="card">
                <div class="card-body">
                  <div class="row g-3">
                    <!-- –û–±–≤–æ–¥–∫–∞ -->
                    <div class="col-md-4">
                      <h6 class="text-muted mb-3">–û–±–≤–æ–¥–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ–ª—è</h6>
                      <div class="form-group">
                        <label class="form-label">–¶–≤–µ—Ç –æ–±–≤–æ–¥–∫–∏</label>
                        <input 
                          type="color" 
                          class="form-control form-control-color" 
                          v-model="strokeColor"
                          title="–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç –æ–±–≤–æ–¥–∫–∏"
                        >
                      </div>
                      <div class="form-group mt-2">
                        <label class="form-label">–¢–æ–ª—â–∏–Ω–∞ –æ–±–≤–æ–¥–∫–∏: {{ strokeWidth }}%</label>
                        <input 
                          type="range" 
                          class="form-range" 
                          v-model.number="strokeWidth"
                          min="0" 
                          max="20" 
                          step="1"
                        >
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import paper from 'paper'
import ThreeDRenderer from '../ThreeDRenderer.vue'
import TextManager from '../TextManager.vue'
import HighQualitySaveButton from '../common/HighQualitySaveButton.vue'

export default {
  name: 'MugComicPage',
  components: {
    ThreeDRenderer,
    TextManager,
    HighQualitySaveButton
  },
  data() {
    return {
      // Canvas –∏ Paper.js
      paperScope: null,
      isLoading: false,
      baseRectangle: null, // –ë–∞–∑–æ–≤—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ –Ω–∞ canvas
      
      // –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
      activeTool: null,
      
      // –í–∫–ª–∞–¥–∫–∏
      activeTab: 'images',
      
      // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
      uploadedImages: [],
      
      // –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Å–ª–æ–∏
      textLayers: [],
      nextTextLayerId: 100, // –ù–∞—á–∞–ª—å–Ω—ã–π ID –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–ª–æ—ë–≤
      
      // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–≤–æ–¥–∫–∏
      strokeColor: '#000000',
      strokeWidth: 5 // –ü—Ä–æ—Ü–µ–Ω—Ç—ã (0-20)
    }
  },
  computed: {
    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ç–æ–ª—â–∏–Ω—É –æ–±–≤–æ–¥–∫–∏ –≤ –ø–∏–∫—Å–µ–ª—è—Ö –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ–ª—è
    strokeWidthPx() {
      if (!this.baseRectangle || !this.paperScope) return 0
      
      // –ë–µ—Ä—ë–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä (—à–∏—Ä–∏–Ω–∞ –∏–ª–∏ –≤—ã—Å–æ—Ç–∞) –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ–ª—è
      const bounds = this.baseRectangle.bounds
      const minDimension = Math.min(bounds.width, bounds.height)
      
      // –í—ã—á–∏—Å–ª—è–µ–º —Ç–æ–ª—â–∏–Ω—É –æ–±–≤–æ–¥–∫–∏ –∫–∞–∫ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
      return (this.strokeWidth / 100) * minDimension
    }
  },
  watch: {
    strokeColor() {
      this.updateBaseRectangle()
    },
    strokeWidth() {
      this.updateBaseRectangle()
    }
  },
  mounted() {
    this.initPaperCanvas()
  },
  beforeUnmount() {
    if (this.paperScope) {
      this.paperScope.remove()
      this.paperScope = null
    }
  },
  methods: {
    // ========== –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Paper.js ==========
    initPaperCanvas() {
      const canvas = this.$refs.comicCanvas
      if (!canvas) {
        console.error('Canvas –Ω–µ –Ω–∞–π–¥–µ–Ω')
        return
      }

      // –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π scope –¥–ª—è Paper.js
      this.paperScope = new paper.PaperScope()
      this.paperScope.setup(canvas)
      
      // –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (.canvas-container)
      const container = canvas.parentElement
      if (!container) {
        console.log('‚ö†Ô∏è –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω')
        return
      }

      // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç padding-bottom –¥–ª—è —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω 19:9
      const width = container.offsetWidth
      const height = container.offsetHeight
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä Paper.js view
      this.paperScope.view.viewSize = new this.paperScope.Size(width, height)
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–µ–ª—ã–π —Ñ–æ–Ω
      const background = new this.paperScope.Path.Rectangle({
        point: [0, 0],
        size: [width, height],
        fillColor: 'white'
      })
      background.sendToBack()
      
      // –°–æ–∑–¥–∞—ë–º –±–∞–∑–æ–≤—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ —Ä–∞–∑–º–µ—Ä–æ–º —Å canvas
      this.createBaseRectangle(width, height)
      
      console.log('Paper.js canvas –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω:', width, 'x', height)
    },

    // ========== –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ ==========
    createBaseRectangle(width, height) {
      if (!this.paperScope) return

      // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é —Ç–æ–ª—â–∏–Ω—É –æ–±–≤–æ–¥–∫–∏
      const minDimension = Math.min(width, height)
      const initialStrokeWidth = (this.strokeWidth / 100) * minDimension

      // –°–æ–∑–¥–∞—ë–º –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ —Ä–∞–∑–º–µ—Ä–æ–º —Å –≤–µ—Å—å canvas
      this.baseRectangle = new this.paperScope.Path.Rectangle({
        point: [0, 0],
        size: [width, height],
        fillColor: null, // –ë–µ–∑ –∑–∞–ª–∏–≤–∫–∏
        strokeColor: this.strokeColor,
        strokeWidth: initialStrokeWidth
      })
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Å—Ç—Ä—ã–µ —É–≥–ª—ã –¥–ª—è —á—ë—Ç–∫–∏—Ö –ª–∏–Ω–∏–π
      this.baseRectangle.strokeJoin = 'miter'
      this.baseRectangle.strokeCap = 'butt'
      
      console.log('‚úÖ –ë–∞–∑–æ–≤—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ —Å–æ–∑–¥–∞–Ω:', {
        size: `${width}x${height}`,
        strokeColor: this.strokeColor,
        strokeWidth: initialStrokeWidth
      })
    },

    // ========== –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ ==========
    updateBaseRectangle() {
      if (!this.baseRectangle || !this.paperScope) return

      // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –æ–±–≤–æ–¥–∫–∏
      this.baseRectangle.strokeColor = this.strokeColor
      this.baseRectangle.strokeWidth = this.strokeWidthPx
      
      // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º view
      this.paperScope.view.update()
      
      // –û–±–Ω–æ–≤–ª—è–µ–º 3D –º–æ–¥–µ–ª—å
      this.update3DTexture()
      
      console.log('üîÑ –ë–∞–∑–æ–≤—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ –æ–±–Ω–æ–≤–ª—ë–Ω:', {
        strokeColor: this.strokeColor,
        strokeWidth: this.strokeWidthPx
      })
    },

    // ========== –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ 3D —Ç–µ–∫—Å—Ç—É—Ä—ã ==========
    update3DTexture() {
      // –ñ–¥—ë–º —Å–ª–µ–¥—É—é—â–∏–π —Ñ—Ä–µ–π–º –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è canvas
      this.$nextTick(() => {
        if (this.$refs.threeRenderer && this.$refs.threeRenderer.updateTexture) {
          this.$refs.threeRenderer.updateTexture()
        }
      })
    },

    // ========== –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ ==========
    handleImageUpload(event) {
      const files = event.target.files
      if (!files || files.length === 0) return

      const remainingSlots = 10 - this.uploadedImages.length
      const filesToProcess = Array.from(files).slice(0, remainingSlots)

      filesToProcess.forEach(file => {
        if (!file.type.startsWith('image/')) {
          console.warn('–§–∞–π–ª –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º:', file.name)
          return
        }

        const reader = new FileReader()
        reader.onload = (e) => {
          this.uploadedImages.push({
            name: file.name,
            url: e.target.result,
            file: file
          })
        }
        reader.readAsDataURL(file)
      })

      // –û—á–∏—â–∞–µ–º input –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
      event.target.value = ''
    },

    removeImage(index) {
      this.uploadedImages.splice(index, 1)
    },

    // ========== –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–º ==========
    openTextManager() {
      if (this.$refs.textManager) {
        this.$refs.textManager.openDialog()
      }
    },

    onTextDialogOpened() {
      console.log('–î–∏–∞–ª–æ–≥ —Ç–µ–∫—Å—Ç–∞ –æ—Ç–∫—Ä—ã—Ç')
    },

    onTextDialogClosed() {
      console.log('–î–∏–∞–ª–æ–≥ —Ç–µ–∫—Å—Ç–∞ –∑–∞–∫—Ä—ã—Ç')
    },

    onTextApplied(event) {
      console.log('üìù TextManager: –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ MugComicPage', event)
      
      const { textData, mode, position, isEditing, editingLayerIndex } = event
      
      if (isEditing && editingLayerIndex !== null) {
        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ç–µ–∫—Å—Ç–∞
        this.updateExistingTextLayer(editingLayerIndex, textData, position, mode)
      } else {
        // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
        this.applyTextToCanvas(textData, position, mode)
      }
      
      // –ó–∞–∫—Ä—ã–≤–∞–µ–º –¥–∏–∞–ª–æ–≥ TextManager –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
      const textManager = this.$refs.textManager
      if (textManager && typeof textManager.closeDialog === 'function') {
        textManager.closeDialog()
      }
      
      // –û–±–Ω–æ–≤–ª—è–µ–º 3D –º–æ–¥–µ–ª—å
      this.$nextTick(() => {
        setTimeout(() => {
          this.update3DTexture()
          console.log('üîÑ 3D –º–æ–¥–µ–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞')
        }, 100)
      })
    },

    // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ canvas (–∫–æ–ø–∏—è –∏–∑ GridsPage)
    applyTextToCanvas(textData, position, mode) {
      console.log('‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –∫–∞–Ω–≤–∞—Å:', textData)
      
      // –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ –∫–∞–Ω–≤–∞—Å-–ø—Ä–µ–≤—å—é (856x405) –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞–Ω–≤–∞—Å
      const previewCanvasWidth = 856
      const previewCanvasHeight = 405
      const mainCanvasWidth = this.paperScope.view.viewSize.width
      const mainCanvasHeight = this.paperScope.view.viewSize.height
      
      const scaleX = mainCanvasWidth / previewCanvasWidth
      const scaleY = mainCanvasHeight / previewCanvasHeight
      
      const scaledPosition = {
        x: position.x * scaleX,
        y: position.y * scaleY
      }
      
      console.log('üéØ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è (—Å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º):', {
        original: { x: position.x, y: position.y },
        scaled: { x: scaledPosition.x, y: scaledPosition.y },
        previewCanvas: `${previewCanvasWidth}x${previewCanvasHeight}`,
        mainCanvas: `${mainCanvasWidth}x${mainCanvasHeight}`,
        scale: `${scaleX.toFixed(3)}x${scaleY.toFixed(3)}`,
        mode: mode
      })
      
      // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —Å–ª–æ–π
      const layerIndex = this.nextTextLayerId
      this.nextTextLayerId += 10
      
      const textLayer = new this.paperScope.Layer()
      textLayer.name = `textLayer_${layerIndex}`
      
      // –°–æ–∑–¥–∞—ë–º —Ñ–æ–Ω–æ–≤—ã–π –∫–∞–Ω–≤–∞—Å —Å —Ç–µ–∫—Å—Ç–æ–º –∏ –ø–æ–¥–ª–æ–∂–∫–æ–π
      const backgroundRaster = this.createBackgroundWithText(textData, scaledPosition, mode)
      
      if (backgroundRaster) {
        textLayer.addChild(backgroundRaster)
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–ª–æ–µ
        const layerInfo = {
          id: layerIndex,
          layer: textLayer,
          textData: textData,
          position: scaledPosition,
          mode: mode,
          raster: backgroundRaster
        }
        
        this.textLayers.push(layerInfo)
        
        console.log('‚úÖ –¢–µ–∫—Å—Ç–æ–≤—ã–π —Å–ª–æ–π —Å–æ–∑–¥–∞–Ω:', layerInfo)
      }
    },

    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ª–æ–∂–∫–∏ —Å —Ç–µ–∫—Å—Ç–æ–º (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏–∑ GridsPage)
    createBackgroundWithText(textData, position, mode) {
      try {
        const canvas = document.createElement('canvas')
        const ctx = canvas.getContext('2d')
        
        // –†–∞–∑–º–µ—Ä—ã –∫–∞–∫ –≤ –ø—Ä–µ–≤—å—é
        canvas.width = 856
        canvas.height = 405
        
        // –í—ã—á–∏—Å–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã —Ç–µ–∫—Å—Ç–∞
        ctx.font = `${textData.fontSize}px ${textData.font || 'Arial'}`
        const textMetrics = ctx.measureText(textData.text)
        const textWidth = textMetrics.width
        const textHeight = textData.fontSize
        
        const padding = textData.padding || 15
        const bgWidth = Math.max(200, textWidth + padding * 2)
        const bgHeight = Math.max(80, textHeight + padding * 2)
        
        // –†–∏—Å—É–µ–º –ø–æ–¥–ª–æ–∂–∫—É
        ctx.save()
        ctx.translate(canvas.width / 2, canvas.height / 2)
        
        // –§–æ–Ω –ø–æ–¥–ª–æ–∂–∫–∏
        ctx.fillStyle = textData.backgroundColor || '#ffffff'
        ctx.fillRect(-bgWidth / 2, -bgHeight / 2, bgWidth, bgHeight)
        
        // –û–±–≤–æ–¥–∫–∞ –ø–æ–¥–ª–æ–∂–∫–∏
        if (textData.stroke) {
          ctx.strokeStyle = textData.strokeColor || '#000000'
          ctx.lineWidth = textData.strokeWidth || 3
          ctx.strokeRect(-bgWidth / 2, -bgHeight / 2, bgWidth, bgHeight)
        }
        
        // –¢–µ–∫—Å—Ç
        ctx.fillStyle = textData.fillColor || '#000000'
        ctx.textAlign = 'center'
        ctx.textBaseline = 'middle'
        ctx.fillText(textData.text, 0, 0)
        
        ctx.restore()
        
        // –°–æ–∑–¥–∞—ë–º Raster –∏–∑ canvas
        const raster = new this.paperScope.Raster(canvas.toDataURL())
        raster.position = new this.paperScope.Point(position.x, position.y)
        
        return raster
        
      } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–æ–Ω–∞ —Å —Ç–µ–∫—Å—Ç–æ–º:', error)
        return null
      }
    },

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–ª–æ—è
    updateExistingTextLayer(layerIndex, textData, position, mode) {
      console.log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–ª–æ—è:', layerIndex)
      
      const layerInfo = this.textLayers[layerIndex]
      if (!layerInfo) {
        console.error('‚ùå –°–ª–æ–π –Ω–µ –Ω–∞–π–¥–µ–Ω:', layerIndex)
        return
      }
      
      // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π raster
      if (layerInfo.raster) {
        layerInfo.raster.remove()
      }
      
      // –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –ø–æ–∑–∏—Ü–∏—é
      const previewCanvasWidth = 856
      const previewCanvasHeight = 405
      const mainCanvasWidth = this.paperScope.view.viewSize.width
      const mainCanvasHeight = this.paperScope.view.viewSize.height
      
      const scaleX = mainCanvasWidth / previewCanvasWidth
      const scaleY = mainCanvasHeight / previewCanvasHeight
      
      const scaledPosition = {
        x: position.x * scaleX,
        y: position.y * scaleY
      }
      
      // –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π raster
      const newRaster = this.createBackgroundWithText(textData, scaledPosition, mode)
      
      if (newRaster) {
        layerInfo.layer.addChild(newRaster)
        layerInfo.textData = textData
        layerInfo.position = scaledPosition
        layerInfo.mode = mode
        layerInfo.raster = newRaster
        
        console.log('‚úÖ –¢–µ–∫—Å—Ç–æ–≤—ã–π —Å–ª–æ–π –æ–±–Ω–æ–≤–ª—ë–Ω')
      }
    },

    editTextLayer(index) {
      const layer = this.textLayers[index]
      if (this.$refs.textManager) {
        this.$refs.textManager.openDialog(layer.textData, index)
      }
    },

    deleteTextLayer(index) {
      if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Å–ª–æ–π?')) {
        const layerInfo = this.textLayers[index]
        
        // –£–¥–∞–ª—è–µ–º Paper.js —Å–ª–æ–π
        if (layerInfo && layerInfo.layer) {
          layerInfo.layer.remove()
        }
        
        // –£–¥–∞–ª—è–µ–º –∏–∑ –º–∞—Å—Å–∏–≤–∞
        this.textLayers.splice(index, 1)
        
        // –û–±–Ω–æ–≤–ª—è–µ–º 3D –º–æ–¥–µ–ª—å
        this.update3DTexture()
      }
    },

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ canvas –¥–ª—è –ø–µ—á–∞—Ç–∏ (300 DPI)
    async saveCanvasForPrint() {
      console.log('üíæ –ù–∞—á–∞–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –≤—ã—Å–æ–∫–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ (300 DPI)')
      
      try {
        const currentCanvas = this.$refs.comicCanvas
        if (!currentCanvas) {
          throw new Error('Canvas –Ω–µ –Ω–∞–π–¥–µ–Ω')
        }
        
        // –ò—Å—Ö–æ–¥–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –≤ –ø–∏–∫—Å–µ–ª—è—Ö
        const originalWidth = currentCanvas.width
        const originalHeight = currentCanvas.height
        
        // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è 300 DPI (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ 96 DPI —ç–∫—Ä–∞–Ω–∞)
        const scale = 300 / 96
        
        // –†–∞–∑–º–µ—Ä—ã –¥–ª—è –ø–µ—á–∞—Ç–∏
        const printWidth = Math.round(originalWidth * scale)
        const printHeight = Math.round(originalHeight * scale)
        
        console.log('üìê –†–∞–∑–º–µ—Ä—ã –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', {
          original: `${originalWidth}x${originalHeight}`,
          print: `${printWidth}x${printHeight}`,
          scale: scale.toFixed(2)
        })
        
        // –°–æ–∑–¥–∞–µ–º canvas –¥–ª—è –ø–µ—á–∞—Ç–∏
        const printCanvas = document.createElement('canvas')
        printCanvas.width = printWidth
        printCanvas.height = printHeight
        const printCtx = printCanvas.getContext('2d')
        
        // –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
        printCtx.imageSmoothingEnabled = true
        printCtx.imageSmoothingQuality = 'high'
        
        // –ë–µ–ª—ã–π —Ñ–æ–Ω
        printCtx.fillStyle = 'white'
        printCtx.fillRect(0, 0, printWidth, printHeight)
        
        // –†–∏—Å—É–µ–º –±–∞–∑–æ–≤—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ (–æ–±–≤–æ–¥–∫—É)
        if (this.baseRectangle && this.strokeWidth > 0) {
          printCtx.strokeStyle = this.strokeColor
          printCtx.lineWidth = this.strokeWidthPx * scale
          printCtx.strokeRect(0, 0, printWidth, printHeight)
        }
        
        // –†–∏—Å—É–µ–º –≤—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–ª–æ–∏
        for (let i = 0; i < this.textLayers.length; i++) {
          const layerInfo = this.textLayers[i]
          
          if (layerInfo.raster && layerInfo.raster.canvas) {
            const rasterCanvas = layerInfo.raster.canvas
            
            // –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –ø–æ–∑–∏—Ü–∏—é
            const scaledX = layerInfo.position.x * scale
            const scaledY = layerInfo.position.y * scale
            
            // –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º —Ä–∞–∑–º–µ—Ä—ã
            const scaledWidth = rasterCanvas.width * scale
            const scaledHeight = rasterCanvas.height * scale
            
            // –†–∏—Å—É–µ–º —Å —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ–º
            printCtx.drawImage(
              rasterCanvas,
              scaledX - scaledWidth / 2,
              scaledY - scaledHeight / 2,
              scaledWidth,
              scaledHeight
            )
          }
        }
        
        // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ blob
        const blob = await new Promise(resolve => {
          printCanvas.toBlob(resolve, 'image/png', 1.0)
        })
        
        // –°–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
        const url = URL.createObjectURL(blob)
        const link = document.createElement('a')
        link.href = url
        link.download = `mug-comic-${Date.now()}.png`
        link.click()
        URL.revokeObjectURL(url)
        
        console.log('‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ')
        return true
        
      } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error)
        throw error
      }
    },

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –∫–Ω–æ–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
    onSaveSuccess() {
      console.log('‚úÖ –§–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω—ë–Ω')
    },

    onSaveError(error) {
      console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error)
      alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞. –°–º. –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.')
    },

    showNotification(message) {
      console.log('üì¢', message)
    },

    // ========== 3D Renderer callbacks ==========
    onThreeInitialized() {
      console.log('ThreeDRenderer –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω')
    },

    onTextureUpdated() {
      // Texture –æ–±–Ω–æ–≤–ª–µ–Ω–∞
    },

    onTextureError(error) {
      console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç—É—Ä—ã:', error)
    }
  }
}
</script>

<style lang="scss" scoped>
.mug-comic-page {
  // –ü—É—Å—Ç–æ–π –±–ª–æ–∫ –¥–ª—è scope
}

/* –°—Ç–∏–ª–∏ –∏–∑ StickerManiaPage */
.page-title {
  color: #016527;
  font-weight: 600;
  margin-bottom: 0.5rem;
}

.canvas-container {
  width: 100%;
  height: 0;
  padding-bottom: 47.37%; /* 19:9 —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ */
  position: relative;
  background: #fff;
}

.comic-canvas {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: block;
  box-shadow: 4px 4px 12px 0 rgba(0,0,0,.15);
}

.canvas-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255, 255, 255, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –Ω–∞–¥ –æ—Å–Ω–æ–≤–Ω—ã–º –∫–∞–Ω–≤–∞—Å–æ–º */
.canvas-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 12px 24px;
  border: none;
  border-radius: 8px;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s ease;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

.canvas-button:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
  color: white !important;
}

.canvas-button:hover:not(:disabled) * {
  color: white !important;
}

.canvas-button:active:not(:disabled) {
  transform: translateY(0);
  box-shadow: 0 2px 10px rgba(102, 126, 234, 0.4);
  color: white !important;
}

.canvas-button:active:not(:disabled) * {
  color: white !important;
}

.canvas-button * {
  color: white !important;
}

.canvas-button:disabled {
  opacity: 0.7;
  cursor: not-allowed;
  transform: none;
}

.text-button {
  width: auto;
  margin-left: 20px;
}

/* –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ */
.tools-panel {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 4px;
  background: #f8f9fa;
  border-radius: 8px;
  border: 1px solid #dee2e6;
  height: 48px; /* –¢–∞ –∂–µ –≤—ã—Å–æ—Ç–∞, —á—Ç–æ –∏ –∫–Ω–æ–ø–∫–∞ "–¢–µ–∫—Å—Ç" */
}

.tool-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  border: none;
  border-radius: 6px;
  background: white;
  color: #495057;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 18px;
}

.tool-button:hover:not(:disabled) {
  background: #e9ecef;
  color: #016527;
  transform: translateY(-1px);
}

.tool-button:active:not(:disabled) {
  transform: translateY(0);
}

.tool-button.active {
  background: #016527;
  color: white;
}

.tool-button:disabled {
  background: #e9ecef;
  color: #adb5bd;
  cursor: not-allowed;
  opacity: 0.6;
}

.nav-tabs .nav-link {
  color: #495057;
  border: none;
  border-bottom: 2px solid transparent;
  padding: 0.75rem 1rem;
  font-weight: 500;
  transition: all 0.2s ease;
}

.nav-tabs .nav-link:hover {
  color: #016527;
  background-color: transparent;
  border-bottom-color: #dee2e6;
}

.nav-tabs .nav-link.active {
  color: #016527;
  background-color: transparent;
  border-bottom-color: #016527;
}

.nav-tabs .nav-link i {
  font-size: 1.1rem;
}

.card {
  border-radius: 0;
  border: none;
  padding: 0;
  margin: 0;
  background: transparent;
}

.card-body {
  padding: 1rem;
}

.card-body.p-0 {
  padding: 0 !important;
}

.btn-primary {
  background-color: #0d70fd;
  border-color: transparent;
  
  &:hover {
    background-color: #2a7ff8;
    border-color: transparent;
  }
}

.btn-outline-primary {
  color: #016527;
  border-color: #016527;
}

.btn-outline-primary:hover {
  background-color: #016527;
  border-color: #016527;
  color: #fff;
}

.form-check-input:checked {
  background-color: #016527;
  border-color: #016527;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 767.98px) {
  .page-title {
    font-size: 1.5rem;
  }

  .canvas-button {
    font-size: 0.9rem;
    padding: 10px 20px;
  }
}

@media (max-width: 575.98px) {
  .page-title {
    font-size: 1.3rem;
  }
}
</style>

